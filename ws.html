<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<title>WebSocket Test</title>
</head>
<style type="text/css">
#content{
	width:100%;
	height: 300px;
	color: #ffffff;
	background-color: #000000
}
#message{
width:100%;
height: 200px;
color: #ffffff;
background-color: #000000
}
form{
	border:1px solid #000;
	padding:5px;
}
</style>
<script type="text/javascript">

</script>
<body>
<h1>WebSocket Test</h1>
<p>
	请求地址：<input id="ws" type="type" placeholder="请输入WebSocket地址" value="ws://"/> 
	<button id="init" onclick="init()">初始化</button>
</p>
终端编号：<input id="device" type="text" placeholder="终端编号,例如：A001,A002" value="A00001"/>
业务类型：<select id="type" onchange="select_type()">
	<option value="setParam">参数配置</option>
	<option value="getParam">查询终端参数</option>
	<option value="devControl">终端控制</option>
	<option value="reportNow">点名</option>
	<option value="reportTemporary">临时跟踪控制</option>
	<option value="sendText">文本下发</option>
	<option value="setEvent">事件设置</option>
	<option value="question">提问下发</option>
	<option value="setInfoMenu">信息点播菜单设置</option>
	<option value="setInfo">服务信息设置</option>
	<option value="callBack">电话回拨</option>
	<option value="setPhoneBook">设置电话本</option>
	<option value="vehicleControl">车辆控制</option>
	<option value="setArea">设置电子围栏</option>
	<option value="setRoute">设置路线</option>
	<option value="delRoute">路线删除</option>
	<option value="getDrivingHistory">采集行驶记录数据</option>
	<option value="snapshot">抓拍命令</option>
	<option value="recording">录音命令</option>
	<option value="mediaSearch">多媒体搜索</option>
	<option value="getMedia">多媒体上传</option>
	<option value="transparentPort">数据透传到设备</option>
	<option value="sendRsa">RSA公钥下发</option>
	<option value="getTrace">轨迹下载</option>
</select>
<select id="setParam" onchange="select_setParam()">
		<option value="">请选择需要配置的参数</option>
	<option value="sbsz">设备设置</option>
	<option value="thjtsz">通话/监听设置</option>
	<option value="clsz">车辆设置</option>
	<option value="fuqcszz">服务器参数设置</option>
	<option value="bjsz">报警设置</option>
</select>
<form id="sbsz">
	<h2>设备设置</h2>
	<h3>注册参数设置</h3>
	<input name="provinceID" placeholder="车辆所在的省域ID"/>
	<input name="cityID" placeholder="车辆所在的市域ID"/>
	<input name="plateNumber" placeholder="车牌号"/>
	<input name="plateColor" placeholder="车牌颜色"/>
	<h3>终端链路参数设置</h3>
	<input name="heartbeat" placeholder="终端心跳发送间隔"/>
	<input name="tcpAnswerTimeout" placeholder="TCP消息应答超时时间"/>
	<input name="tcpRepeatCount" placeholder="TCP消息重传次数"/>
	<input name="udpAnswerTimeout" placeholder="UDP消息应答超时时间"/>
	<input name="udpRepeatCount" placeholder="UDP消息重传次数"/>
	<input name="smsAnswerTimeout" placeholder="SMS消息应答超时时间"/>
	<input name="smsRepeatCount" placeholder="SMS消息重传次数"/>
</form>
<form id="fuqcszz">
	<h2>服务器参数设置</h2>
	<input name="apn" placeholder="无线通信拨号访问点/PPP拨号号码"/>
	<input name="apnUser" placeholder="主服务器无线通信拨号用户名"/>
	<input name="apnPassword" placeholder="主服务器无线通信拨号密码"/>
	<input name="serverAddress" placeholder="主服务器地址/IP或域名"/>
	<input name="backupApn" placeholder="备份服务器APN，无线通信拨号访问点"/>
	<input name="backupApnUser" placeholder="备份服务器无线通信拨号用户名"/>
	<input name="backupApnPassword" placeholder="备份服务器无线通信拨号密码"/>
	<input name="backupServerAddress" placeholder="备份服务器地址/IP或域名"/>
	<input name="tcpPort" placeholder="服务器TCP端口"/>
	<input name="udpPort" placeholder="服务器UDP端口"/>
</form>
<form id="clsz">
	<h2>车辆设置</h2>
	<h3>位置汇报策略</h3>
	<select name="locationReportingStrategy" placeholder="位置汇报策略">
		<option value="0">定时汇报</option>
		<option value="1">定距汇报</option>
		<option value="2">定时和定距汇报</option>
	</select>
	<h3>位置汇报方案</h3>
	<select name="locationReportingBasis" placeholder="位置汇报方案">
		<option value="0">根据ACC状态</option>
		<option value="1">根据登录状态和ACC状态</option>
	</select>
	<h3>驾驶时长设置</h3>
	<input name="overSpeedDuration" placeholder="超速持续时间"/>
	<input name="odometerReadings" placeholder="车辆里程表读数" />
	<input name="maxContinousDrivingTime" placeholder="连续驾驶时间"/>
	<input name="maxDrivingTime" placeholder="当天累计驾驶时间门限"/>
	<input name="maxParkingTime"placeholder="最长停车时间"/>
	<input name="minRestTime" placeholder="最小休息时间"/>
	<input name="maxSpeed" placeholder="最高速度"/>
	<h3>上报时间间隔参数设置</h3>
	<input name="intervalDefault" placeholder="缺省时间汇报间隔" />
	<input name="intervalWhenNotLoggedIn" placeholder="驾驶员未登录汇报时间间隔" />
	<input name="intervalWhenSleep" placeholder="休眠时汇报时间间隔" />
	<input name="intervalWhenEmergence" placeholder="紧急报警时汇报时间间隔" />
	<h3>上报距离间隔参数设置</h3>
	<input name="distanceDefault" placeholder="缺省距离汇报间隔" />
	<input name="distanceWhenNotLoggedIn" placeholder="驾驶员未登录汇报距离间隔" />
	<input name="distanceWhenSleep" placeholder="休眠时汇报距离间隔" />
	<input name="distanceWhenEmergence" placeholder="紧急报警时汇报距离间隔" />
	<input name="inflectionPointAnglur" placeholder="拐点补传角度" />
</form>
<form id="bjsz">
	<h2>报警设置</h2>
	<h3>报警屏蔽字参数设置</h3>
	<input name="alarmMask" placeholder="报警屏蔽字" />
	<input name="alarmSMSMask" placeholder="报警发送文本SMS开关" />
	<input name="alarmSnapshotMask" placeholder="报警拍摄开关" />
	<input name="alarmSnapshotStorageMask" placeholder="报警拍摄存储标志" />
	<input name="keyMask" placeholder="关键标志" />
</form>
<form id="thjtsz">
	<h2>通话/监听设置</h2>
	<h3>通话限制参数设置</h3>
	<select name="devicePickUpStrategy" placeholder="终端电话接听策略">
		<option value="0">自动接听</option>
		<option value="1">ACCON自动接听</option>
	</select>
	<input name="maxTalkLengthPerTime" placeholder="每次最长通话时间" />
	<input name="maxTalkLengthPerMonth" placeholder="当月最长通话时间" />
	<input name="monitoringPhoneNumber" placeholder="监听电话号码" />
	<input name="privilegeSMSPhoneNumber" placeholder="监管平台特权短信号码" />
	<h3>图像参数设置</h3>
	<input name="imageOrVideoQuality" placeholder="图像/视频质量" />
	<input name="brightness" placeholder="亮度" />
	<input name="contrast" placeholder="对比度" />
	<input name="saturation" placeholder="饱和度" />
	<input name="chroma" placeholder="色度" />
	<h3>相关电话号码参数设置</h3>
	<input name="platformPhoneNumber" placeholder="监控平台电话号码" />
	<input name="resetPhoneNumber" placeholder="恢复出厂设置电话号码" />
	<input name="receiveDeviceSMSPhoneNumber" placeholder="接收终端SMS文本报警号码" />
	<input name="platformSMSPhoneNumber" placeholder="监控平台SMS电话号码" />
	<input name="retartPhoneNumber" placeholder="复位电话号码" />
</form>
<!--终端控制-->
<form id="devControl">
	<h3>控制码</h3>
	<select id="controlCode">
		<option value="1">终端升级</option>
		<option value="2">服务器切换</option>
		<option value="3">终端关机</option>
		<option value="4">终端复位</option>
		<option value="5">终端恢复出厂设置</option>
		<option value="6">关闭数据通讯</option>
		<option value="7">关闭所有无线通讯</option>
	</select>
	<h3>无线升级</h3>
	<input name="url" placeholder="URL地址" />
	<input name="apn" placeholder="拨号点名称" />
	<input name="apnUser" placeholder="拨号用户名" />
	<input name="apnPassword" placeholder="拨号密码" />
	<input name="serverAddress" placeholder="服务器地址" />
	<input name="tcpPort" placeholder="TCP端口" />
	<input name="udpPort" placeholder="UDP端口" />
	<input name="udpPortmanufacturerCode" placeholder="制造商ID" />
	<input name="hardwareVersion" placeholder="终端的硬件版本号" />
	<input name="firmwareVersion" placeholder="终端的固件版本号" />
	<input name="returnMinute" placeholder="连接到指定服务时限" />
</form>

<form id="sendText">
	<h3>文本类型</h3>
	<select id="textType">
		<option value="0">紧急</option>
		<option value="2">终端显示</option>
		<option value="3">TTS播报</option>
		<option value="4">广告屏幕</option>
	</select>
	<input id="sendText_content" placeholder="文本内容" />
</form>

<form id="setEvent">
		<h3>设置类型</h3>
		<select id="operType">
			<option value="0">删除所有事件</option>
			<option value="1">更新事件</option>
			<option value="2">追加事件</option>
			<option value="3">修改事件</option>
			<option value="3">删除指定事件</option>
		</select>
		<input id="eventType"  placeholder="事件id"/>
		<input id="setEvent_content"  placeholder="事件内容"/>
</form>

<form id="question">
		<h3>问题类型</h3>
		<select id="questionType">
			<option value="0">紧急</option>
			<option value="1">TTS播报</option>
			<option value="2">广告屏幕</option>
		</select>
		<input id="question_content"  placeholder="问题内容"/>
		<input id="answerId"  placeholder="答案id"/>
		<input id="answer_content"  placeholder="答案内容"/>
</form>

<form id="callBack">
		<h3>回拨类型</h3>
		<select id="questionType">
			<option value="0">普通通话</option>
			<option value="1">监听</option>
		</select>
		<input id="callBackNumber"  placeholder="电话号码"/>
</form>

<form id="setPhoneBook">
		<h3>操作类型</h3>
		<select id="setPhoneBook_operType">
			<option value="0">删除所有</option>
			<option value="1">更新</option>
			<option value="2">追加</option>
			<option value="3">修改</option>
		</select>
		<h3>号码权限</h3>
		<select id="privilege">
			<option value="1">仅呼入</option>
			<option value="2">仅呼出</option>
			<option value="3">呼出呼入</option>
		</select>
		<input id="contact"  placeholder="联系人"/>
		<input id="phoneNumber"  placeholder="目标电话"/>
</form>

<form id="setArea">
		<h3>操作类型</h3>
		<select id="setArea_operType">
			<option value="0">删除所有围栏</option>
			<option value="1">更新</option>
			<option value="2">追加</option>
			<option value="3">修改</option>
			<option value="4">删除指定围栏</option>
		</select>
		<h3>围栏类型</h3>
		<select id="setArea_areaType">
			<option value="0">圆型</option>
			<option value="1">矩形</option>
			<option value="2">多边形</option>
		</select>
		<input id="areaIds"  placeholder="围栏IDS"/>

		<input id="setArea_id"  placeholder="围栏ID"/>
		<h3>圆形</h3>
		<input id="centerLat"  placeholder="中心点纬度"/>
		<input id="centerLng"  placeholder="中心点经度"/>
		<input id="radius"  placeholder="半径"/>
		<h3>矩形</h3>
		<input id="leftTopLat"  placeholder="左上角纬度"/>
		<input id="leftTopLng"  placeholder="左上角经度"/>
		<input id="rightBottomLat"  placeholder="右下角纬度"/>
		<input id="rightBottomLng"  placeholder="右下角经度"/>
		<h3>多边形</h3>
		<input id="lat1"  placeholder="纬度1"/>
		<input id="lng1"  placeholder="经度1"/>
		<input id="lat2"  placeholder="纬度2"/>
		<input id="lng2"  placeholder="经度2"/>
		<input id="lat3"  placeholder="纬度3"/>
		<input id="lng3"  placeholder="经度3"/>
		<h3>通用参数</h3>
		<input id="startTime"  placeholder="开始时间"/>
		<input id="endTime"  placeholder="结束时间"/>
		<input id="maxSpeed"  placeholder="最大速度"/>
		<input id="overSpeedDuration"  placeholder="超速阈值"/>

		<input id="useTimeSpan"  placeholder="启用时间0/1"/>
		<input id="useSpeedLimit"  placeholder="启用限速0/1"/>
		<input id="warmToDriverWhenLeaving"  placeholder="出围栏向司机报警"/>
		<input id="warmToDriverWhenEntering"  placeholder="进围栏向司机报警"/>
		<input id="notifyToPlatformWhenLeaving"  placeholder="出围栏向平台报警"/>
		<input id="notifyToPlatformWhenEntering"  placeholder="进围栏向平台报警"/>
</form>
<form id="setRoute">
	<h3>通用参数</h3>
	<input id="setRoute_roadWidth"  placeholder="路宽"/>
	<input id="setRoute_maxDrivingTime"  placeholder="路段最大行驶时间"/>
	<input id="setRoute_minDrivingTime"  placeholder="路段最小形式时间"/>
	<input id="setRoute_maxSpeed"  placeholder="最高行驶速度"/>
	<input id="setRoute_overSpeedDuration"  placeholder="最小超速时间"/>
	<input id="setRoute_routeId"  placeholder="线路ID"/>
	<input id="setRoute_startTime"  placeholder="开始时间"/>
	<input id="setRoute_endTime"  placeholder="结束时间"/>

	<input id="setRoute_useTimeSpan"  placeholder="启用时间0/1"/>
	<input id="setRoute_useSpeedLimit"  placeholder="启用限速0/1"/>
	<input id="setRoute_warmToDriverWhenLeaving"  placeholder="出围栏向司机报警"/>
	<input id="setRoute_warmToDriverWhenEntering"  placeholder="进围栏向司机报警"/>
	<input id="setRoute_notifyToPlatformWhenLeaving"  placeholder="出围栏向平台报警"/>
	<input id="setRoute_notifyToPlatformWhenEntering"  placeholder="进围栏向平台报警"/>
	<h3>拐点</h3>
	<input id="setRoute_roadId"  placeholder="路段ID"/>
	<input id="setRoute_lat"  placeholder="纬度1"/>
	<input id="setRoute_lng"  placeholder="经度1"/>
	
	<h3>路段属性</h3>
	<input id="setRoute_useDrivingTime"  placeholder="启用驾驶时间条件"/>
	<input id="setRoute_useSpeedLimit"  placeholder="启用路段限速条件"/>
</form>

<form id="snapshot">
		<h3>操作类型</h3>
		<select id="snapshotType">
			<option value="0">抓拍</option>
			<option value="1">录像</option>
		</select>
		<input id="channel"  placeholder="通道数"/>
		<input id="number"  placeholder="抓拍张数"/>
		<input id="lnterval"  placeholder="抓拍间隔"/>
		<input id="recordingTime"  placeholder="录像时间"/>
		<select id="upload">
			<option value="true">上传</option>
			<option value="false">不上传</option>
		</select>
		<select id="resolution">
			<option value="0">320*240</option>
			<option value="1">640*480</option>
		</select>
		<select id="compress">
			<option value="0">1</option>
			<option value="1">2</option>
		</select>
		<input id="brightness"  placeholder="亮度"/>
		<input id="contrast"  placeholder="对比度"/>
		<input id="saturation"  placeholder="饱和度"/>
		<input id="chroma"  placeholder="色度"/>
</form>
<form id="recording">
	<select id="recording_action">
		<option value="0">停止录音</option>
		<option value="1">开始录音</option>
	</select>
	<input id="recording_recordTime"  placeholder="录音时长"/>
	<select id="recording_upload">
		<option value="true">上传</option>
		<option value="false">不上传</option>
	</select>
	<select id="recording_sampleRate">
		<option value="0">0:8k</option>
		<option value="1">1:11k</option>
	</select>
</form>
<form id="mediaSearch">
	<select id="mediaSearch_mediaType">
		<option value="0">图像</option>
		<option value="1">音频</option>
		<option value="2">视频</option>
	</select>
	<input id="mediaSearch_channel"  placeholder="通道号"/>
	<select id="mediaSearch_eventType">
		<option value="0">平台下发指令</option>
		<option value="1">定时动作</option>
		<option value="2">抢劫报警触发</option>
		<option value="3">碰撞侧翻报警</option>
	</select>
	<input id="mediaSearch_startTime"  placeholder="开始时间"/>
	<input id="mediaSearch_endTime"  placeholder="结束时间"/>
</form>
<form id="getMedia">
		<select id="getMedia_mediaType">
			<option value="0">图像</option>
			<option value="1">音频</option>
			<option value="2">视频</option>
		</select>
		<input id="getMedia_channel"  placeholder="通道号"/>
		<select id="getMedia_eventType">
			<option value="0">平台下发指令</option>
			<option value="1">定时动作</option>
			<option value="2">抢劫报警触发</option>
			<option value="3">碰撞侧翻报警</option>
		</select>
		<input id="getMedia_startTime"  placeholder="开始时间"/>
		<input id="getMedia_endTime"  placeholder="结束时间"/>
		<select id="getMedia_delete">
				<option value="true">删除</option>
				<option value="false">保留</option>
			</select>
	</form>

<button id="production"  onclick="createMessage()">生成数据</button>
<button id="clear" style="float:right" onclick="clearMessage()">清理数据</button>
<p/>
<textarea id="message">
第一步：输入ws协议地址，点击初始化按钮。
第二步：选择需要测试的业务类型，点击生成数据按钮。
第三步：对生成的数据值进行修改，默认会生成默认值。
第四步：点击发送数据按钮，观察下方控制台结果即可。
</textarea>
<br/>
<button id="fs" onclick="message()">发送数据</button>
<p/>
<textarea id="content">
hello web socket
</textarea>
<button id="clear"  onclick="clearContent()">清理控制台</button>


<script type="text/javascript" src="js/lib/jquery/1.9.1/jquery.min.js" ></script>
<script type="text/javascript" src="ws.js" ></script>
<script type="text/javascript">

//初始化

$("form").hide();

select_setParam();
var ws =new ws();
function init(){
	var dz=$("#ws").val();
	var option={
		url:dz,
		open:function(){
			$("#content").append(new Date().toLocaleString()+":测试open方法\n");
		},
		onmessage:function(data){
			
			$("#content").append(new Date().toLocaleString()+":服务器返回数据 开始\n");
			//处理服务器数据 JSON.stringify
			reaction(data);
			$("#content").append(new Date().toLocaleString()+":服务器返回数据 结束\n");
		},
		onerror:function(){
			$("#content").append(new Date().toLocaleString()+":测试onerror方法\n");
		},
		onclose:function(){
			$("#content").append(new Date().toLocaleString()+":测试onclose方法\n");
		},
		heartCheck :{
			timeout: 10000,//60ms
			timeoutObj: null,
			serverTimeoutObj: null,
			reset: function(_this){
				clearTimeout(this.timeoutObj);
				this.start(_this);
			},
			start: function(_this){
				var self = this;
				this.timeoutObj = setTimeout(function(){
					_this.websocket.send("HeartBeat", "beat");
				}, this.timeout)
			},
		}
	}

	if(null==dz||dz.length<=0||'ws://'==dz){
		$("#content").append(new Date().toLocaleString()+":地址不能为空\n");
		return;
	}
	ws.init(option);
	if(!window.isW){
		$("#content").append(new Date().toLocaleString()+":连接失败，请检查ws协议地址\n");
	}
	
}
function clearMessage(){
	$("#message").val("");
}
function clearContent(){
	$("#content").val("");
}
function createMessage(){
	var cmd=$("#type").val();
	var session="klsstt";
	var devidno=$("#device").val();
	var message="";
	if('setParam'==cmd){//参数配置
		var formId=$("#setParam").val();
		message=findData(formId);
		var json="{"+
		"\"cmd\":\""+cmd+"\","+
		"\"session\":\""+session+"\","+
		"\"devIdno\":\""+devidno+"\","+
		"\"parameters\":"+message+"}";
	}
	if('devControl'==cmd){//终端控制
		var controlCode=$("#controlCode").val();
		message=findData('devControl');
		if(controlCode==1||controlCode==2){
			var json="{"+
			"\"cmd\":\""+cmd+"\","+
			"\"session\":\""+session+"\","+
			"\"devIdno\":\""+devidno+"\","+
			"\"controlCode\":\""+controlCode+"\","+
			"\"data\":"+message+"}";
		}else{
			var json="{"+
			"\"cmd\":\""+cmd+"\","+
			"\"session\":\""+session+"\","+
			"\"devIdno\":\""+devidno+"\","+
			"\"controlCode\":\""+controlCode+"\",}";
		}
	
	}
	if("getParam"==cmd||"reportNow"==cmd){//参数查询,点名
		var json="{"+
			"\"cmd\":\""+cmd+"\","+
			"\"session\":\""+session+"\","+
			"\"devIdno\":\""+devidno+"\"}";
	}
	if("reportTemporary"==cmd){//临时跟踪控制
		var json="{"+
		"\"cmd\":\""+cmd+"\","+
		"\"session\":\""+session+"\","+
		"\"devIdno\":\""+devidno+"\","+
		"\"interval\":\"0\","+
		"\"span\":\"0\""+
		"}";
	}
	if("sendText"==cmd){//文本下发
		var textType=$("#textType").val();
		message=$("#sendText_content").val();
		var json="{"+
		"\"cmd\":\""+cmd+"\","+
		"\"session\":\""+session+"\","+
		"\"devIdno\":\""+devidno+"\","+
		"\"content\":\""+message+"\","+
		"\"textType\":\""+textType+"\""
		+"}";
	}

	if("setEvent"==cmd){//事件设置
		var operType=$("#operType").val();
		var eventType=$("#eventType").val();
		message=$("#setEvent_content").val();
		var json="{"+
		"\"cmd\":\""+cmd+"\","+
		"\"session\":\""+session+"\","+
		"\"devIdno\":\""+devidno+"\","+
		"\"content\":\""+message+"\","+
		"\"eventType\":\""+eventType+"\","+
		"\"operType\":\""+operType+"\""
		+"}";
	}

	if("question"==cmd){//提问下发
		var questionType=$("#questionType").val();
		message=$("#question_content").val();
		var answerId=$("#answerId").val();
		var answer_content=$("#answer_content").val();
		var json="{"+
		"\"cmd\":\""+cmd+"\","+
		"\"session\":\""+session+"\","+
		"\"devIdno\":\""+devidno+"\","+
		"\"content\":\""+answer_content+"\","+
		"\"answerId\":\""+answerId+"\","+
		"\"question\":\""+message+"\","+
		"\"questionType\":\""+questionType+"\""
		+"}";
	}

	if("setInfoMenu"==cmd){//信息点播
		var json="{"+
		"\"cmd\":\""+cmd+"\","+
		"\"session\":\""+session+"\","+
		"\"devIdno\":\""+devidno+"\","+
		"\"operType\":\"0\","+
		"\"menus\":{\"infoType:\"0\","+
		"\"text\":\"holle\"}"+
		"}";
	}

	if("setInfo"==cmd){//服务信息设置
		var json="{"+
		"\"cmd\":\""+cmd+"\","+
		"\"session\":\""+session+"\","+
		"\"devIdno\":\""+devidno+"\","+
		"\"infoType\":\"0\","+
		"\"content\":\"信息内容\""+
		"}";
	}

	if("callBack"==cmd){//电话回拨
		var questionType=$("#questionType").val();
		var callBackNumber=$("#callBackNumber").val();
		var json="{"+
		"\"cmd\":\""+cmd+"\","+
		"\"session\":\""+session+"\","+
		"\"devIdno\":\""+devidno+"\","+
		"\"questionType\":\""+questionType+"\","+
		"\"callBackNumber\":\""+callBackNumber+"\""+
		"}";
	}

	if("setPhoneBook"==cmd){//设置电话本
		var operType=$("#setPhoneBook_operType").val();
		var privilege=$("#privilege").val();
		var contact=$("#contact").val();
		var phoneNumber=$("#phoneNumber").val();
		var json="{"+
		"\"cmd\":\""+cmd+"\","+
		"\"session\":\""+session+"\","+
		"\"devIdno\":\""+devidno+"\","+
		"\"operType\":\""+operType+"\","+
		"\"privilege\":\""+privilege+"\""+
		"\"phoneNumber\":\""+phoneNumber+"\""+
		"\"contact\":\""+contact+"\""+
		"}";
	}

	if("vehicleControl"==cmd){//车辆控制
		var json="{"+
		"\"cmd\":\""+cmd+"\","+
		"\"session\":\""+session+"\","+
		"\"devIdno\":\""+devidno+"\","+
		"\"controlCode\":\"0\","+
		"}";
	}
	
	if("setArea"==cmd){//设置电子围栏
		var operType=$("#setArea_operType").val();
		var areaType=$("#setArea_areaType").val();
		var areaIds=$("#areaIds").val();
		var id=$("#setArea_id").val();
		var startTime=$("#startTime").val();
		var endTime=$("#endTime").val();
		var maxSpeed=$("#maxSpeed").val();
		var overSpeedDuration=$("#overSpeedDuration").val();

		var useTimeSpan=$("#useTimeSpan").val();
		var useSpeedLimit=$("#useSpeedLimit").val();
		var warmToDriverWhenLeaving=$("#warmToDriverWhenLeaving").val();
		var warmToDriverWhenEntering=$("#warmToDriverWhenEntering").val();
		var notifyToPlatformWhenLeaving=$("#notifyToPlatformWhenLeaving").val();
		var notifyToPlatformWhenEntering=$("#notifyToPlatformWhenEntering").val();
		var properties="{"+
			"\"useTimeSpan\":\""+useTimeSpan+"\","+
			"\"useSpeedLimit\":\""+useSpeedLimit+"\","+
			"\"warmToDriverWhenLeaving\":\""+warmToDriverWhenLeaving+"\","+
			"\"warmToDriverWhenEntering\":\""+warmToDriverWhenEntering+"\","+
			"\"notifyToPlatformWhenLeaving\":\""+notifyToPlatformWhenLeaving+"\","+
			"\"notifyToPlatformWhenEntering\":\""+notifyToPlatformWhenEntering+"\""+
		"}";
		if("0"==areaType){
			var centerLat=$("#centerLat").val();
			var centerLng=$("#centerLng").val();
			var radius=$("#radius").val();
			message="[{"+
		
			"\"centerLat\":\""+centerLat+"\","+
			"\"centerLng\":\""+centerLng+"\","+
			"\"radius\":\""+radius+"\","+

			"\"id\":\""+id+"\","+
			"\"startTime\":\""+startTime+"\","+
			"\"endTime\":\""+endTime+"\","+
			"\"maxSpeed\":\""+maxSpeed+"\","+
			"\"overSpeedDuration\":\""+overSpeedDuration+"\","+
			"\"properties\":\""+properties+"\""+
			"}]";
		}
		if("1"==areaType){
			var leftTopLat=$("#leftTopLat").val();
			var leftTopLng=$("#leftTopLng").val();
			var rightBottomLat=$("#rightBottomLat").val();
			var rightBottomLng=$("#rightBottomLng").val();
			message="[{"+
		
			"\"leftTopLat\":\""+leftTopLat+"\","+
			"\"leftTopLng\":\""+leftTopLng+"\","+
			"\"rightBottomLat\":\""+rightBottomLat+"\","+
			"\"rightBottomLng\":\""+rightBottomLng+"\","+

			"\"id\":\""+id+"\","+
			"\"startTime\":\""+startTime+"\","+
			"\"endTime\":\""+endTime+"\","+
			"\"maxSpeed\":\""+maxSpeed+"\","+
			"\"overSpeedDuration\":\""+overSpeedDuration+"\","+
			"\"properties\":\""+properties+"\""+
			"}]";
		}
		if("2"==areaType){
			var lat1=$("#lat1").val();
			var lng1=$("#lng1").val();
			var lat2=$("#lat2").val();
			var lng2=$("#lng2").val();
			var lat3=$("#lat3").val();
			var lng3=$("#lng3").val();
			var points="[{"+
				"\"lat\":\""+lat1+"\","+
				"\"lng\":\""+lng1+"\""+
			+"},{"+
				"\"lat\":\""+lat2+"\","+
				"\"lng\":\""+lng2+"\""+
			+"},{"+
				"\"lat\":\""+lat3+"\","+
				"\"lng\":\""+lng3+"\""+
			+"}]";
			message="[{"+
			"\"points\":\""+points+"\","+
			"\"id\":\""+id+"\","+
			"\"startTime\":\""+startTime+"\","+
			"\"endTime\":\""+endTime+"\","+
			"\"maxSpeed\":\""+maxSpeed+"\","+
			"\"overSpeedDuration\":\""+overSpeedDuration+"\","+
			"\"properties\":\""+properties+"\""+
			"}]";
		}
		var json="{"+
		"\"cmd\":\""+cmd+"\","+
		"\"session\":\""+session+"\","+
		"\"devIdno\":\""+devidno+"\","+
		"\"operType\":\""+operType+"\","+
		"\"areaType\":\""+areaType+"\","+
		"\"areaIds\":\""+areaIds+"\","+
		"\"ares\":"+message+"}";
	}

	if("setRoute"==cmd){//设置线路
		
		var roadWidth=$("#setRoute_roadWidth").val();
		var maxDrivingTime=$("#setRoute_maxDrivingTime").val();
		var minDrivingTime=$("#setRoute_minDrivingTime").val();
		var maxSpeed=$("#setRoute_maxSpeed").val();
		var overSpeedDuration=$("#setRoute_overSpeedDuration").val();
		var routeId=$("#setRoute_routeId").val();
		var startTime=$("#setRoute_startTime").val();
		var endTime=$("#setRoute_endTime").val();

		var useTimeSpan=$("#setRoute_useTimeSpan").val();
		var useSpeedLimit=$("#setRoute_useSpeedLimit").val();
		var warmToDriverWhenLeaving=$("#setRoute_warmToDriverWhenLeaving").val();
		var warmToDriverWhenEntering=$("#setRoute_warmToDriverWhenEntering").val();
		var notifyToPlatformWhenLeaving=$("#setRoute_notifyToPlatformWhenLeaving").val();
		var notifyToPlatformWhenEntering=$("#setRoute_notifyToPlatformWhenEntering").val();
		var properties="{"+
			"\"useTimeSpan\":\""+useTimeSpan+"\","+
			"\"useSpeedLimit\":\""+useSpeedLimit+"\","+
			"\"warmToDriverWhenLeaving\":\""+warmToDriverWhenLeaving+"\","+
			"\"warmToDriverWhenEntering\":\""+warmToDriverWhenEntering+"\","+
			"\"notifyToPlatformWhenLeaving\":\""+notifyToPlatformWhenLeaving+"\","+
			"\"notifyToPlatformWhenEntering\":\""+notifyToPlatformWhenEntering+"\""+
		"}";
		var setRoute_useDrivingTime=$("#setRoute_useDrivingTime").val();
		var setRoute_useSpeedLimit=$("#setRoute_useSpeedLimit").val();
		var roadProperties="{"
			"\"useDrivingTime\":\""+setRoute_useDrivingTime+"\","+
			"\"setRoute_useSpeedLimit\":\""+setRoute_useSpeedLimit+"\""+
		"}";
		var lat1=$("#setRoute_lat").val();
		var lng1=$("#setRoute_lng").val();
		var inflectionPoints="[{"+//拐点
			"\"lat\":\""+lat1+"\","+
			"\"lng\":\""+lng1+"\""+
			"\"maxDrivingTime\":\""+maxDrivingTime+"\""+
			"\"minDrivingTime\":\""+minDrivingTime+"\""+
			"\"roadWidth\":\""+roadWidth+"\""+
			"\"maxSpeed\":\""+maxSpeed+"\","+
			"\"overSpeedDuration\":\""+overSpeedDuration+"\","+
			"\"roadProperties\":\""+roadProperties+"\""+
		    "}]";
		var json="{"+
		"\"cmd\":\""+cmd+"\","+
		"\"session\":\""+session+"\","+
		"\"devIdno\":\""+devidno+"\","+
		"\"routeId\":\""+routeId+"\","+
		"\"id\":\"1\","+
		"\"startTime\":\""+startTime+"\","+
		"\"endTime\":\""+endTime+"\","+
		"\"properties\":\""+properties+"\""+
		"\"inflectionPoints\":\""+inflectionPoints+"\""+
	"}";
	}
	if("delRoute"==cmd){//删除线路
		var json="{"+
		"\"cmd\":\""+cmd+"\","+
		"\"session\":\""+session+"\","+
		"\"devIdno\":\""+devidno+"\","+
		"\"operType\":\"0\","+
		"\"routeIds\":\"1\""+
		"}";
	}
	if("getDrivingHistory"==cmd){//采集行驶记录数据
		var json="{"+
		"\"cmd\":\""+cmd+"\","+
		"\"session\":\""+session+"\","+
		"\"devIdno\":\""+devidno+"\","+
		"\"dataType\":\"0\""+
		"}";
	}
	if("snapshot"==cmd){//抓拍命令
		var snapshotType=$("#snapshotType").val();
		var channel=$("#channel").val();
		var number=$("#number").val();
		var lnterval=$("#lnterval").val();
		var recordingTime=$("#recordingTime").val();
		var upload=$("#upload").val();
		var resolution=$("#resolution").val();
		var compress=$("#compress").val();
		var brightness=$("#brightness").val();
		var contrast=$("#contrast").val();
		var saturation=$("#saturation").val();
		var chroma=$("#chroma").val();
		var json="{"+
		"\"cmd\":\""+cmd+"\","+
		"\"session\":\""+session+"\","+
		"\"devIdno\":\""+devidno+"\","+
		"\"snapshotType\":\""+snapshotType+"\","+
		"\"channel\":\""+channel+"\","+
		"\"number\":\""+number+"\","+
		"\"lnterval\":\""+lnterval+"\","+
		"\"recordingTime\":\""+recordingTime+"\","+
		"\"upload\":\""+upload+"\","+
		"\"resolution\":\""+resolution+"\","+
		"\"compress\":\""+compress+"\","+
		"\"brightness\":\""+brightness+"\","+
		"\"contrast\":\""+contrast+"\","+
		"\"saturation\":\""+saturation+"\","+
		"\"chroma\":\""+chroma+"\""+
		"}";
	}
	if("recording"==cmd){//录音命令
		var action=$("#recording_action").val();
		var recordTime=$("#recording_recordTime").val();
		var upload=$("#recording_upload").val();
		var sampleRate=$("#recording_sampleRate").val();
		var json="{"+
		"\"cmd\":\""+cmd+"\","+
		"\"session\":\""+session+"\","+
		"\"devIdno\":\""+devidno+"\","+
		"\"action\":\""+action+"\","+
		"\"recordTime\":\""+recordTime+"\","+
		"\"upload\":\""+upload+"\","+
		"\"sampleRate\":\""+sampleRate+"\""+
		"}";
	}

	if("mediaSearch"==cmd){//多媒体搜索
		var mediaType=$("#mediaSearch_mediaType").val();
		var channel=$("#mediaSearch_channel").val();
		var eventType=$("#mediaSearch_eventType").val();
		var startTime=$("#mediaSearch_startTime").val();
		var endTime=$("#mediaSearch_endTime").val();
		var json="{"+
		"\"cmd\":\""+cmd+"\","+
		"\"session\":\""+session+"\","+
		"\"devIdno\":\""+devidno+"\","+
		"\"mediaType\":\""+mediaType+"\","+
		"\"channel\":\""+channel+"\","+
		"\"eventType\":\""+eventType+"\","+
		"\"endTime\":\""+endTime+"\","+
		"\"startTime\":\""+startTime+"\""+
		"}";
	}
	if("getMedia"==cmd){//多媒体上传
		var mediaType=$("#getMedia_mediaType").val();
		var channel=$("#getMedia_channel").val();
		var eventType=$("#getMedia_eventType").val();
		var startTime=$("#getMedia_startTime").val();
		var endTime=$("#getMedia_endTime").val();
		var getMedia_delete=$("#getMedia_delete").val();
		var json="{"+
		"\"cmd\":\""+cmd+"\","+
		"\"session\":\""+session+"\","+
		"\"devIdno\":\""+devidno+"\","+
		"\"mediaType\":\""+mediaType+"\","+
		"\"channel\":\""+channel+"\","+
		"\"eventType\":\""+eventType+"\","+
		"\"delete\":\""+getMedia_delete+"\","+
		"\"endTime\":\""+endTime+"\","+
		"\"startTime\":\""+startTime+"\""+
		"}";
	}
	if("transparentPort"==cmd){//数据透传到外设
		var json="{"+
		"\"cmd\":\""+cmd+"\","+
		"\"session\":\""+session+"\","+
		"\"devIdno\":\""+devidno+"\","+
		"\"dataType\":\"1\","+
		"\"content\":\"数据透传内容\""+
		"}";
	}

	if("sendRsa"==cmd){//RSA公钥下发
		var json="{"+
		"\"cmd\":\""+cmd+"\","+
		"\"session\":\""+session+"\","+
		"\"devIdno\":\""+devidno+"\","+
		"\"eField\":\"E\","+
		"\"nField\":\"N\""+
		"}";
	}
	if("getTrace"==cmd){//轨迹下载
		var json="{"+
		"\"cmd\":\""+cmd+"\","+
		"\"session\":\""+session+"\","+
		"\"devIdno\":\""+devidno+"\","+
		"\"pageSize\":\"20\","+
		"\"offset\":\"1\","+
		"\"startTime\":\"E\","+
		"\"endTime\":\"N\""+
		"}";
	}
	$("#message").val(json);
	

}
function message(){
	if(window.isW){
		var json=$("#message").val();
		ws.sendWs(jQuery.parseJSON(json));
	}
}
function reaction(data){
	$("#content").append(new Date().toLocaleString()+":"+data+"\n");
}
function select_setParam(){
	$("form").hide();
	var setParam=$("#setParam").val();
	$("#"+setParam).show();
}
function select_type(){
	$("form").hide();
	var type=$("#type").val();
	if("setParam"==type){
		$("#setParam").show();
	}else{
		$("#setParam").hide();
	}
	$("#"+type).show();
}
function getElements(formId) {    
    var form = document.getElementById(formId);    
    var elements = new Array();    
    var tagElements = form.getElementsByTagName('input');    
    for (var j = 0; j < tagElements.length; j++){  
         elements.push(tagElements[j]);  
    }  
	tagElements = form.getElementsByTagName('select');    
    for (var j = 0; j < tagElements.length; j++){  
         elements.push(tagElements[j]);  
    }  
    return elements;    
}
function findData(id){
	var elements=getElements(id);
  	var json={};
  	for (var i = 0; i < elements.length; i++) {
      	var name=$(elements[i]).attr("name");
      	if(undefined!=name&&null!=name){
      		json[name]=encodeURI($(elements[i]).val());
          }
  	}
  	return JSON.stringify(json);
}
</script>
</body>
</html>